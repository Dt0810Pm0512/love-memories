<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ëá¥ÊàëÁöÑ‰πñ‰πñ - ‰∏ìÂ±ûÁà±ÊÉÖÁ∫™ÂøµÂÜå</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css" rel="stylesheet">
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#FF6B9D',
                        secondary: '#C44569',
                        accent: '#F8B500',
                        love: {
                            50: '#FFF0F5',
                            100: '#FFE4E6',
                            200: '#FFB6C1',
                            300: '#FF69B4',
                            400: '#FF1493',
                            500: '#DA70D6',
                            600: '#DDA0DD',
                            700: '#9370DB',
                            800: '#8A2BE2',
                            900: '#9932CC'
                        }
                    },
                    fontFamily: {
                        romantic: ['Georgia', 'serif'],
                        elegant: ['Inter', 'sans-serif']
                    },
                    animation: {
                        'float': 'float 6s ease-in-out infinite',
                        'pulse-slow': 'pulse 3s cubic-bezier(0.4, 0, 0.6, 1) infinite',
                        'bounce-slow': 'bounce 2s infinite',
                        'glow': 'glow 2s ease-in-out infinite alternate',
                        'celebrate': 'celebrate 0.6s ease-out',
                        'sparkle': 'sparkle 1.5s ease-in-out infinite',
                        'fadeInUp': 'fadeInUp 0.8s ease-out',
                        'scaleIn': 'scaleIn 0.5s ease-out',
                        'heartExplosion': 'heartExplosion 1s ease-out',
                        'floatHeart': 'floatHeart 3s ease-in-out infinite',
                        'rotate3d': 'rotate3d 20s linear infinite',
                        'pulseGlow': 'pulseGlow 2s ease-in-out infinite',
                        'wave': 'wave 2s ease-in-out infinite'
                    },
                    keyframes: {
                        float: {
                            '0%, 100%': { transform: 'translateY(0px)' },
                            '50%': { transform: 'translateY(-20px)' }
                        },
                        glow: {
                            '0%': { boxShadow: '0 0 20px rgba(255, 107, 157, 0.5)' },
                            '100%': { boxShadow: '0 0 30px rgba(255, 107, 157, 0.8), 0 0 40px rgba(255, 107, 157, 0.3)' }
                        },
                        celebrate: {
                            '0%': { transform: 'scale(0.5)', opacity: '0' },
                            '50%': { transform: 'scale(1.1)' },
                            '100%': { transform: 'scale(1)', opacity: '1' }
                        },
                        sparkle: {
                            '0%, 100%': { transform: 'scale(1) rotate(0deg)' },
                            '50%': { transform: 'scale(1.2) rotate(180deg)' }
                        },
                        fadeInUp: {
                            '0%': { transform: 'translateY(30px)', opacity: '0' },
                            '100%': { transform: 'translateY(0)', opacity: '1' }
                        },
                        scaleIn: {
                            '0%': { transform: 'scale(0)', opacity: '0' },
                            '100%': { transform: 'scale(1)', opacity: '1' }
                        },
                        heartExplosion: {
                            '0%': { transform: 'scale(1)', opacity: '1' },
                            '50%': { transform: 'scale(1.5)', opacity: '0.8' },
                            '100%': { transform: 'scale(2)', opacity: '0' }
                        },
                        floatHeart: {
                            '0%, 100%': { transform: 'translateY(0px) rotate(0deg)' },
                            '50%': { transform: 'translateY(-15px) rotate(5deg)' }
                        },
                        rotate3d: {
                            '0%': { transform: 'rotateX(0deg) rotateY(0deg)' },
                            '100%': { transform: 'rotateX(360deg) rotateY(360deg)' }
                        },
                        pulseGlow: {
                            '0%, 100%': { boxShadow: '0 0 5px rgba(255, 107, 157, 0.5)' },
                            '50%': { boxShadow: '0 0 20px rgba(255, 107, 157, 0.8)' }
                        },
                        wave: {
                            '0%, 100%': { transform: 'scaleX(1)' },
                            '50%': { transform: 'scaleX(1.1)' }
                        }
                    }
                }
            }
        }
    </script>
    <style type="text/tailwindcss">
        @layer utilities {
            .content-auto {
                content-visibility: auto;
            }
            .gradient-love {
                background: linear-gradient(135deg, #FF6B9D 0%, #C44569 50%, #9B59B6 100%);
            }
            .gradient-text {
                background: linear-gradient(135deg, #FF6B9D, #9B59B6);
                -webkit-background-clip: text;
                -webkit-text-fill-color: transparent;
                background-clip: text;
            }
            .glass-effect {
                background: rgba(255, 255, 255, 0.25);
                backdrop-filter: blur(10px);
                border: 1px solid rgba(255, 255, 255, 0.18);
            }
            .heart-beat {
                animation: heartbeat 1.5s ease-in-out infinite;
            }
            .floating-hearts::before {
                content: 'üíï';
                position: absolute;
                animation: floatHeart 3s ease-in-out infinite;
            }
            .parallax-bg {
                background-attachment: fixed;
                background-position: center;
                background-repeat: no-repeat;
                background-size: cover;
            }
            .text-shadow {
                text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
            }
            .hover-lift {
                transition: transform 0.3s ease, box-shadow 0.3s ease;
            }
            .hover-lift:hover {
                transform: translateY(-8px);
                box-shadow: 0 20px 40px rgba(255, 107, 157, 0.3);
            }
            @keyframes heartbeat {
                0% { transform: scale(1); }
                14% { transform: scale(1.1); }
                28% { transform: scale(1); }
                42% { transform: scale(1.1); }
                70% { transform: scale(1); }
            }
            .delete-btn {
                opacity: 1 !important;
                transition: all 0.3s ease;
                animation: pulseGlow 2s ease-in-out infinite;
            }
            .delete-btn:hover {
                transform: scale(1.2);
                background-color: #ef4444 !important;
                animation: none;
                box-shadow: 0 0 15px rgba(239, 68, 68, 0.6);
            }
            .love-particles {
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                pointer-events: none;
                z-index: 1000;
            }
        }
    </style>
</head>
<body class="min-h-screen overflow-x-hidden" style="background-image: url('https://aka.doubaocdn.com/s/ngDd1vPAgQ'); background-size: cover; background-position: center; background-attachment: fixed;">
    
    <!-- Áà±ÊÉÖÁ≤íÂ≠êËÉåÊôØ -->
    <div class="love-particles" id="loveParticles"></div>
    
    <!-- ÊµÆÂä®Áà±ÂøÉË£ÖÈ•∞ -->
    <div class="fixed inset-0 pointer-events-none overflow-hidden">
        <div class="absolute top-20 left-10 text-4xl text-love-300 opacity-60 animate-float" style="animation-delay: 0s;">üíï</div>
        <div class="absolute top-40 right-20 text-3xl text-love-400 opacity-50 animate-float" style="animation-delay: 1s;">üíñ</div>
        <div class="absolute bottom-32 left-1/4 text-5xl text-love-200 opacity-40 animate-float" style="animation-delay: 2s;">üíò</div>
        <div class="absolute bottom-20 right-1/3 text-4xl text-love-500 opacity-50 animate-float" style="animation-delay: 3s;">üíù</div>
        <div class="absolute top-1/2 left-1/3 text-3xl text-love-300 opacity-60 animate-float" style="animation-delay: 4s;">üíì</div>
        <div class="absolute top-1/3 right-1/4 text-4xl text-love-400 opacity-50 animate-floatHeart" style="animation-delay: 0.5s;">üíû</div>
        <div class="absolute bottom-1/3 left-1/2 text-3xl text-love-300 opacity-60 animate-floatHeart" style="animation-delay: 1.5s;">üíó</div>
    </div>

    <!-- ÂØºËà™Ê†è -->
    <nav class="relative z-50 glass-effect border-b border-white/20">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between items-center h-16">
                <div class="flex items-center space-x-3">
                    <div class="w-10 h-10 gradient-love rounded-full flex items-center justify-center heart-beat animate-glow">
                        <i class="fa fa-heart text-white text-lg"></i>
                    </div>
                    <h1 class="text-xl font-elegant font-bold gradient-text">Ëá¥ÊàëÁöÑ‰πñ‰πñ</h1>
                </div>
                <div class="hidden md:flex items-center space-x-8">
                    <a href="#home" class="text-white hover:text-love-200 transition-colors duration-300">È¶ñÈ°µ</a>
                    <a href="#timer" class="text-white hover:text-love-200 transition-colors duration-300">Áà±ÊÉÖËÆ°Êó∂Âô®</a>
                    <a href="#album" class="text-white hover:text-love-200 transition-colors duration-300">ÁîúËúúÁõ∏ÂÜå</a>
                    <a href="#diary" class="text-white hover:text-love-200 transition-colors duration-300">Áà±ÊÉÖÊó•ËÆ∞</a>
                    <a href="#messages" class="text-white hover:text-love-200 transition-colors duration-300">ÁîúËúúÁïôË®Ä</a>
                    <a href="#anniversary" class="text-white hover:text-love-200 transition-colors duration-300">Á∫™ÂøµÊó•</a>
                    <button onclick="syncAllData()" class="text-white hover:text-love-200 transition-colors duration-300 hover:scale-110 transition-transform relative">
                        <i class="fa fa-refresh text-lg"></i>
                        <span id="syncBadge" class="absolute -top-2 -right-2 w-4 h-4 bg-green-500 rounded-full text-xs text-white flex items-center justify-center hidden">‚úì</span>
                    </button>
                </div>
                <button class="md:hidden text-white hover:scale-110 transition-transform">
                    <i class="fa fa-bars text-xl"></i>
                </button>
            </div>
        </div>
    </nav>

    <!-- ‰∏ªÈ°µËã±ÈõÑÂå∫Âüü -->
    <section id="home" class="relative z-10 min-h-screen flex items-center justify-center">
        <div class="text-center text-white px-4 max-w-4xl mx-auto animate-fadeInUp">
            <div class="mb-8 animate-bounce-slow">
                <div class="w-32 h-32 gradient-love rounded-full flex items-center justify-center mx-auto heart-beat animate-glow relative">
                    <i class="fa fa-heart text-white text-6xl"></i>
                    <!-- ÊóãËΩ¨ÁöÑÁà±ÂøÉË£ÖÈ•∞ -->
                    <div class="absolute -top-4 -right-4 text-2xl animate-rotate3d">üí´</div>
                    <div class="absolute -bottom-4 -left-4 text-2xl animate-rotate3d" style="animation-direction: reverse;">‚ú®</div>
                </div>
            </div>
            <h1 class="text-5xl md:text-7xl font-romantic font-bold mb-6 gradient-text text-shadow animate-scaleIn">
                Ëá¥ÊàëÁöÑ‰πñ‰πñ
            </h1>
            <p class="text-xl md:text-2xl mb-8 font-elegant opacity-90 leading-relaxed animate-fadeInUp" style="animation-delay: 0.3s;">
                ÊØè‰∏ÄÂ§©ÈÉΩÊÉ≥ÂëäËØâ‰Ω†Ôºå‰Ω†ÊòØÊàëÁîüÂëΩ‰∏≠ÊúÄÁæéÁöÑÁ§ºÁâ©<br>
                ËøôÊòØÂè™Â±û‰∫éÊàë‰ª¨‰∏§‰∏™‰∫∫ÁöÑÁà±ÊÉÖÂ∞èÁ´ô
            </p>
            <div class="flex flex-col sm:flex-row gap-4 justify-center items-center animate-fadeInUp" style="animation-delay: 0.6s;">
                <button onclick="scrollToSection('timer')" class="px-8 py-4 gradient-love rounded-full text-white font-semibold hover:scale-105 transition-transform duration-300 animate-glow hover-lift">
                    <i class="fa fa-clock-o mr-2"></i>Êü•ÁúãÊàë‰ª¨ÁöÑÁà±ÊÉÖÊó∂ÂÖâ
                </button>
                <button onclick="scrollToSection('messages')" class="px-8 py-4 glass-effect rounded-full text-white font-semibold hover:scale-105 transition-transform duration-300 hover-lift">
                    <i class="fa fa-heart mr-2"></i>Áªô‰πñ‰πñÂÜôÁïôË®Ä
                </button>
                <button onclick="syncAllData()" class="px-6 py-4 bg-green-500 hover:bg-green-600 rounded-full text-white font-semibold hover:scale-105 transition-transform duration-300 hover-lift">
                    <i class="fa fa-refresh mr-2"></i>ÂêåÊ≠•Êï∞ÊçÆ
                </button>
            </div>
        </div>
    </section>

    <!-- Áà±ÊÉÖËÆ°Êó∂Âô® -->
    <section id="timer" class="relative z-10 py-20">
        <div class="max-w-6xl mx-auto px-4">
            <div class="text-center mb-16">
                <h2 class="text-4xl md:text-5xl font-romantic font-bold gradient-text mb-4 animate-fadeInUp">Áà±ÊÉÖËÆ°Êó∂Âô®</h2>
                <p class="text-xl text-white/80 font-elegant animate-fadeInUp" style="animation-delay: 0.2s;">ËÆ∞ÂΩïÊàë‰ª¨Áõ∏Áà±ÁöÑÊØè‰∏ÄÂàÜÊØè‰∏ÄÁßí</p>
            </div>
            
            <div class="glass-effect rounded-3xl p-8 md:p-12 max-w-4xl mx-auto hover-lift">
                <!-- Ë°®ÁôΩÂºÄÂßãÊåâÈíÆ -->
                <div id="proposalSection" class="text-center mb-12 animate-fadeInUp">
                    <div class="w-24 h-24 gradient-love rounded-full flex items-center justify-center mx-auto mb-6 animate-pulse-slow animate-glow">
                        <i class="fa fa-heart text-white text-4xl"></i>
                    </div>
                    <h3 class="text-2xl font-elegant font-semibold text-white mb-4">‰∫≤Áà±ÁöÑ‰πñ‰πñ</h3>
                    <p class="text-lg text-white/80 font-elegant mb-8 max-w-2xl mx-auto leading-relaxed">
                        ÈÅáËßÅ‰Ω†ÊòØÊàëÁîüÂëΩ‰∏≠ÊúÄÁæéÂ•ΩÁöÑ‰∫ãÊÉÖ„ÄÇ‰ªéÁ¨¨‰∏ÄÊ¨°ËßÅÂà∞‰Ω†ÁöÑÈÇ£‰∏ÄÂàªËµ∑ÔºåÊàëÂ∞±Áü•ÈÅì‰Ω†ÊòØÊàëË¶ÅÊâæÁöÑÈÇ£‰∏™‰∫∫„ÄÇ
                        ÊÑøÊÑèËÆ©Êàë‰ª¨ÁöÑÁà±ÊÉÖ‰ªéËøô‰∏ÄÂàªÂºÄÂßãËÆ°Êó∂ÂêóÔºü
                    </p>
                    <button id="startLoveTimer" onclick="startLoveTimer()" class="px-12 py-4 gradient-love rounded-full text-white font-semibold text-lg hover:scale-110 transition-transform duration-300 animate-glow hover-lift">
                        <i class="fa fa-heart mr-2"></i>ÊàëÊÑøÊÑèÔºåËÆ©Êàë‰ª¨ÂºÄÂßãÂêßÔºÅ
                    </button>
                </div>
                
                <!-- ËÆ°Êó∂Âô®ÊòæÁ§∫Âå∫Âüü -->
                <div id="timerSection" class="hidden">
                    <div class="text-center mb-8">
                        <h3 class="text-2xl font-elegant font-semibold text-white mb-2 animate-fadeInUp">Êàë‰ª¨Âú®‰∏ÄËµ∑Â∑≤Áªè</h3>
                        <div class="flex justify-center items-center space-x-6 md:space-x-12" id="loveTimer">
                            <div class="text-center animate-scaleIn" style="animation-delay: 0.1s;">
                                <div class="text-4xl md:text-6xl font-bold gradient-text mb-2" id="days">0</div>
                                <div class="text-white/70 font-elegant">Â§©</div>
                            </div>
                            <div class="text-center animate-scaleIn" style="animation-delay: 0.2s;">
                                <div class="text-4xl md:text-6xl font-bold gradient-text mb-2" id="hours">0</div>
                                <div class="text-white/70 font-elegant">Êó∂</div>
                            </div>
                            <div class="text-center animate-scaleIn" style="animation-delay: 0.3s;">
                                <div class="text-4xl md:text-6xl font-bold gradient-text mb-2" id="minutes">0</div>
                                <div class="text-white/70 font-elegant">ÂàÜ</div>
                            </div>
                            <div class="text-center animate-scaleIn" style="animation-delay: 0.4s;">
                                <div class="text-4xl md:text-6xl font-bold gradient-text mb-2" id="seconds">0</div>
                                <div class="text-white/70 font-elegant">Áßí</div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- ÊéßÂà∂ÊåâÈíÆ -->
                    <div class="text-center mb-8">
                        <button onclick="pauseTimer()" id="pauseBtn" class="px-6 py-2 mx-2 bg-yellow-500 hover:bg-yellow-600 rounded-full text-white font-semibold transition-colors duration-300 hover:scale-105">
                            <i class="fa fa-pause mr-1"></i>ÊöÇÂÅú
                        </button>
                        <button onclick="resumeTimer()" id="resumeBtn" class="px-6 py-2 mx-2 bg-green-500 hover:bg-green-600 rounded-full text-white font-semibold transition-colors duration-300 hover:scale-105 hidden">
                            <i class="fa fa-play mr-1"></i>ÁªßÁª≠
                        </button>
                        <button onclick="resetTimer()" class="px-6 py-2 mx-2 bg-red-500 hover:bg-red-600 rounded-full text-white font-semibold transition-colors duration-300 hover:scale-105">
                            <i class="fa fa-bullseye mr-1"></i>ÈáçÁΩÆ
                        </button>
                    </div>
                    
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mt-12">
                        <div class="text-center p-6 glass-effect rounded-2xl hover-lift animate-fadeInUp" style="animation-delay: 0.1s;">
                            <div class="w-16 h-16 gradient-love rounded-full flex items-center justify-center mx-auto mb-4 animate-pulseGlow">
                                <i class="fa fa-sun-o text-white text-2xl"></i>
                            </div>
                            <div class="text-2xl font-bold text-white mb-2" id="sunriseCount">0</div>
                            <div class="text-white/70 font-elegant">‰∏™Êó•Âá∫</div>
                        </div>
                        <div class="text-center p-6 glass-effect rounded-2xl hover-lift animate-fadeInUp" style="animation-delay: 0.2s;">
                            <div class="w-16 h-16 gradient-love rounded-full flex items-center justify-center mx-auto mb-4 animate-pulseGlow">
                                <i class="fa fa-moon-o text-white text-2xl"></i>
                            </div>
                            <div class="text-2xl font-bold text-white mb-2" id="sunsetCount">0</div>
                            <div class="text-white/70 font-elegant">‰∏™Êó•ËêΩ</div>
                        </div>
                        <div class="text-center p-6 glass-effect rounded-2xl hover-lift animate-fadeInUp" style="animation-delay: 0.3s;">
                            <div class="w-16 h-16 gradient-love rounded-full flex items-center justify-center mx-auto mb-4 animate-pulseGlow">
                                <i class="fa fa-heart text-white text-2xl"></i>
                            </div>
                            <div class="text-2xl font-bold text-white mb-2">‚àû</div>
                            <div class="text-white/70 font-elegant">‰ªΩÁà±ÊÑè</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- ÁîúËúúÁõ∏ÂÜå -->
    <section id="album" class="relative z-10 py-20">
        <div class="max-w-6xl mx-auto px-4">
            <div class="text-center mb-16">
                <h2 class="text-4xl md:text-5xl font-romantic font-bold gradient-text mb-4 animate-fadeInUp">ÁîúËúúÁõ∏ÂÜå</h2>
                <p class="text-xl text-white/80 font-elegant animate-fadeInUp" style="animation-delay: 0.2s;">ËÆ∞ÂΩïÊàë‰ª¨ÁöÑÊØè‰∏Ä‰∏™ÁæéÂ•ΩÁû¨Èó¥</p>
            </div>
            
            <!-- ‰∏ä‰º†ÁÖßÁâáÂå∫Âüü -->
            <div class="text-center mb-12 animate-fadeInUp" style="animation-delay: 0.3s;">
                <label class="px-8 py-4 gradient-love rounded-full text-white font-semibold hover:scale-105 transition-transform duration-300 cursor-pointer animate-glow hover-lift">
                    <i class="fa fa-plus mr-2"></i>‰∏ä‰º†Êñ∞ÁÖßÁâá
                    <input type="file" id="photoUpload" accept="image/*" multiple class="hidden" onchange="uploadPhotos(event)">
                </label>
            </div>
            
            <div id="photoGrid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                <!-- ÁÖßÁâáÂ∞ÜÈÄöËøáJavaScriptÂä®ÊÄÅÂä†ËΩΩ -->
            </div>
        </div>
    </section>

    <!-- Áà±ÊÉÖÊó•ËÆ∞ -->
    <section id="diary" class="relative z-10 py-20">
        <div class="max-w-4xl mx-auto px-4">
            <div class="text-center mb-16">
                <h2 class="text-4xl md:text-5xl font-romantic font-bold gradient-text mb-4 animate-fadeInUp">Áà±ÊÉÖÊó•ËÆ∞</h2>
                <p class="text-xl text-white/80 font-elegant animate-fadeInUp" style="animation-delay: 0.2s;">ÂÜô‰∏ãÊàë‰ª¨ÁöÑÁà±ÊÉÖÊïÖ‰∫ã</p>
            </div>
            
            <!-- Ê∑ªÂä†Êó•ËÆ∞ÊåâÈíÆ -->
            <div class="text-center mb-12 animate-fadeInUp" style="animation-delay: 0.3s;">
                <button onclick="showAddDiaryModal()" class="px-8 py-4 gradient-love rounded-full text-white font-semibold hover:scale-105 transition-transform duration-300 animate-glow hover-lift">
                    <i class="fa fa-pencil mr-2"></i>ÂÜôÊñ∞Êó•ËÆ∞
                </button>
            </div>
            
            <div id="diaryList" class="space-y-6">
                <!-- Êó•ËÆ∞Â∞ÜÈÄöËøáJavaScriptÂä®ÊÄÅÂä†ËΩΩ -->
            </div>
        </div>
    </section>

    <!-- Ê∑ªÂä†Êó•ËÆ∞Ê®°ÊÄÅÊ°Ü -->
    <div id="addDiaryModal" class="fixed inset-0 bg-black/50 backdrop-blur-sm z-50 hidden">
        <div class="flex items-center justify-center min-h-screen p-4">
            <div class="glass-effect rounded-3xl p-8 max-w-2xl w-full hover-lift animate-scaleIn">
                <div class="flex justify-between items-center mb-6">
                    <h3 class="text-2xl font-semibold text-white">ÂÜôÊñ∞Êó•ËÆ∞</h3>
                    <button onclick="hideAddDiaryModal()" class="text-white/60 hover:text-white hover:scale-110 transition-transform">
                        <i class="fa fa-times text-xl"></i>
                    </button>
                </div>
                
                <div class="space-y-4">
                    <input type="text" id="diaryTitle" placeholder="Êó•ËÆ∞Ê†áÈ¢ò" class="w-full p-3 rounded-xl bg-white/10 border border-white/20 text-white placeholder-white/60 focus:outline-none focus:border-love-300 focus:ring-2 focus:ring-love-300">
                    <input type="date" id="diaryDate" class="w-full p-3 rounded-xl bg-white/10 border border-white/20 text-white placeholder-white/60 focus:outline-none focus:border-love-300 focus:ring-2 focus:ring-love-300">
                    <textarea id="diaryContent" placeholder="ÂÜô‰∏ã‰Ω†‰ª¨ÁöÑÊïÖ‰∫ã..." class="w-full h-32 p-3 rounded-xl bg-white/10 border border-white/20 text-white placeholder-white/60 focus:outline-none focus:border-love-300 focus:ring-2 focus:ring-love-300 resize-none font-elegant"></textarea>
                    <div class="flex space-x-4">
                        <button onclick="hideAddDiaryModal()" class="flex-1 py-3 border border-white/30 text-white rounded-xl hover:bg-white/10 transition-colors duration-300 hover:scale-105">
                            ÂèñÊ∂à
                        </button>
                        <button onclick="addDiary()" class="flex-1 py-3 gradient-love rounded-xl text-white font-semibold hover:scale-105 transition-transform duration-300 animate-glow">
                            ‰øùÂ≠òÊó•ËÆ∞
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- ÁîúËúúÁïôË®Ä -->
    <section id="messages" class="relative z-10 py-20">
        <div class="max-w-4xl mx-auto px-4">
            <div class="text-center mb-16">
                <h2 class="text-4xl md:text-5xl font-romantic font-bold gradient-text mb-4 animate-fadeInUp">ÁîúËúúÁïôË®Ä</h2>
                <p class="text-xl text-white/80 font-elegant animate-fadeInUp" style="animation-delay: 0.2s;">ÊÉ≥ÂØπ‰πñ‰πñËØ¥ÁöÑÊÇÑÊÇÑËØù</p>
            </div>
            
            <!-- ÁïôË®ÄËæìÂÖ•Ê°Ü -->
            <div class="glass-effect rounded-3xl p-8 mb-12 hover-lift animate-fadeInUp" style="animation-delay: 0.3s;">
                <h3 class="text-2xl font-semibold text-white mb-6 text-center">Áªô‰πñ‰πñÂÜôÂøÉÈáåËØù</h3>
                <textarea id="messageInput" placeholder="‰∫≤Áà±ÁöÑ‰πñ‰πñÔºåÊàëÊÉ≥ÂØπ‰Ω†ËØ¥..." class="w-full h-32 p-4 rounded-2xl bg-white/10 border border-white/20 text-white placeholder-white/60 focus:outline-none focus:border-love-300 focus:ring-2 focus:ring-love-300 resize-none font-elegant transition-all duration-300 hover:border-love-200"></textarea>
                <div class="flex justify-between items-center mt-4">
                    <div class="text-white/60 text-sm font-elegant">
                        <i class="fa fa-heart text-love-300 mr-1"></i>
                        ËÆ©Áà±ËØ≠‰º†ÈÄí‰∏ãÂéª
                    </div>
                    <button onclick="addMessage()" class="px-8 py-3 gradient-love rounded-full text-white font-semibold hover:scale-105 transition-transform duration-300 animate-glow hover-lift">
                        <i class="fa fa-send mr-2"></i>ÂèëÈÄÅÁªô‰πñ‰πñ
                    </button>
                </div>
            </div>
            
            <!-- ÁïôË®ÄÂàóË°® -->
            <div id="messageList" class="space-y-6">
                <!-- ÁïôË®ÄÂ∞ÜÈÄöËøáJavaScriptÂä®ÊÄÅÂä†ËΩΩ -->
            </div>
        </div>
    </section>

    <!-- ÈáçË¶ÅÁ∫™ÂøµÊó• -->
    <section id="anniversary" class="relative z-10 py-20">
        <div class="max-w-6xl mx-auto px-4">
            <div class="text-center mb-16">
                <h2 class="text-4xl md:text-5xl font-romantic font-bold gradient-text mb-4 animate-fadeInUp">ÈáçË¶ÅÁ∫™ÂøµÊó•</h2>
                <p class="text-xl text-white/80 font-elegant animate-fadeInUp" style="animation-delay: 0.2s;">ÊØè‰∏Ä‰∏™ÂÄºÂæóÂ∫ÜÁ•ùÁöÑÁâπÊÆäÊó•Â≠ê</p>
            </div>
            
            <!-- Ê∑ªÂä†Á∫™ÂøµÊó•ÊåâÈíÆ -->
            <div class="text-center mb-12 animate-fadeInUp" style="animation-delay: 0.3s;">
                <button onclick="showAddAnniversaryModal()" class="px-8 py-4 gradient-love rounded-full text-white font-semibold hover:scale-105 transition-transform duration-300 animate-glow hover-lift">
                    <i class="fa fa-plus mr-2"></i>Ê∑ªÂä†Á∫™ÂøµÊó•
                </button>
            </div>
            
            <div id="anniversaryGrid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                <!-- Á∫™ÂøµÊó•Â∞ÜÈÄöËøáJavaScriptÂä®ÊÄÅÂä†ËΩΩ -->
            </div>
        </div>
    </section>

    <!-- Ê∑ªÂä†Á∫™ÂøµÊó•Ê®°ÊÄÅÊ°Ü -->
    <div id="addAnniversaryModal" class="fixed inset-0 bg-black/50 backdrop-blur-sm z-50 hidden">
        <div class="flex items-center justify-center min-h-screen p-4">
            <div class="glass-effect rounded-3xl p-8 max-w-md w-full hover-lift animate-scaleIn">
                <div class="flex justify-between items-center mb-6">
                    <h3 class="text-2xl font-semibold text-white">Ê∑ªÂä†Á∫™ÂøµÊó•</h3>
                    <button onclick="hideAddAnniversaryModal()" class="text-white/60 hover:text-white hover:scale-110 transition-transform">
                        <i class="fa fa-times text-xl"></i>
                    </button>
                </div>
                
                <div class="space-y-4">
                    <input type="text" id="anniversaryTitle" placeholder="Á∫™ÂøµÊó•ÂêçÁß∞" class="w-full p-3 rounded-xl bg-white/10 border border-white/20 text-white placeholder-white/60 focus:outline-none focus:border-love-300 focus:ring-2 focus:ring-love-300">
                    <input type="date" id="anniversaryDate" class="w-full p-3 rounded-xl bg-white/10 border border-white/20 text-white placeholder-white/60 focus:outline-none focus:border-love-300 focus:ring-2 focus:ring-love-300">
                    <select id="anniversaryIcon" class="w-full p-3 rounded-xl bg-white/10 border border-white/20 text-white focus:outline-none focus:border-love-300 focus:ring-2 focus:ring-love-300">
                        <option value="heart">‚ù§Ô∏è Áà±ÂøÉ</option>
                        <option value="gift">üéÅ Á§ºÁâ©</option>
                        <option value="star">‚≠ê ÊòüÊòü</option>
                        <option value="calendar">üìÖ Êó•ÂéÜ</option>
                        <option value="camera">üì∑ Áõ∏Êú∫</option>
                        <option value="ring">üíç ÊàíÊåá</option>
                        <option value="music">üéµ Èü≥‰πê</option>
                        <option value="travel">‚úàÔ∏è ÊóÖË°å</option>
                    </select>
                    <div class="flex space-x-4">
                        <button onclick="hideAddAnniversaryModal()" class="flex-1 py-3 border border-white/30 text-white rounded-xl hover:bg-white/10 transition-colors duration-300 hover:scale-105">
                            ÂèñÊ∂à
                        </button>
                        <button onclick="addAnniversary()" class="flex-1 py-3 gradient-love rounded-xl text-white font-semibold hover:scale-105 transition-transform duration-300 animate-glow">
                            ‰øùÂ≠òÁ∫™ÂøµÊó•
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- È°µËÑö -->
    <footer class="relative z-10 py-12 border-t border-white/20">
        <div class="max-w-6xl mx-auto px-4 text-center">
            <div class="flex items-center justify-center space-x-3 mb-6 animate-fadeInUp">
                <div class="w-10 h-10 gradient-love rounded-full flex items-center justify-center heart-beat animate-glow">
                    <i class="fa fa-heart text-white"></i>
                </div>
                <h3 class="text-2xl font-elegant font-bold gradient-text">Ëá¥ÊàëÁöÑ‰πñ‰πñ</h3>
            </div>
            <p class="text-white/70 font-elegant mb-6 max-w-2xl mx-auto leading-relaxed animate-fadeInUp" style="animation-delay: 0.2s;">
                ÊÑøÊàë‰ª¨ÁöÑÁà±ÊÉÖÂÉèËøôÁΩëÁ´ô‰∏ÄÊ†∑ÔºåÊ∞∏ËøúÁæéÂ•Ω„ÄÅÊ∞∏ËøúÊñ∞È≤ú„ÄÇÊØè‰∏ÄÂ§©ÈÉΩÊòØÊñ∞ÁöÑÂºÄÂßãÔºåÊØè‰∏ÄÂàªÈÉΩÂÄºÂæóÁèçÊÉú„ÄÇ
                ËøôÊòØÂè™Â±û‰∫éÊàë‰ª¨‰∏§‰∏™‰∫∫ÁöÑÁà±ÊÉÖÂ∞èÁ´ôÔºåËÆ∞ÂΩïÁùÄÊàë‰ª¨ÊúÄÁæéÂ•ΩÁöÑÂõûÂøÜ„ÄÇ
            </p>
            <div class="flex justify-center space-x-6 mb-8 animate-fadeInUp" style="animation-delay: 0.3s;">
                <button onclick="scrollToSection('home')" class="w-12 h-12 gradient-love rounded-full flex items-center justify-center hover:scale-110 transition-transform duration-300 hover-lift">
                    <i class="fa fa-heart text-white"></i>
                </button>
                <button onclick="scrollToSection('album')" class="w-12 h-12 gradient-love rounded-full flex items-center justify-center hover:scale-110 transition-transform duration-300 hover-lift">
                    <i class="fa fa-camera text-white"></i>
                </button>
                <button onclick="scrollToSection('diary')" class="w-12 h-12 gradient-love rounded-full flex items-center justify-center hover:scale-110 transition-transform duration-300 hover-lift">
                    <i class="fa fa-book text-white"></i>
                </button>
                <button onclick="scrollToSection('messages')" class="w-12 h-12 gradient-love rounded-full flex items-center justify-center hover:scale-110 transition-transform duration-300 hover-lift">
                    <i class="fa fa-gift text-white"></i>
                </button>
            </div>
            <div class="text-white/50 text-sm font-elegant animate-fadeInUp" style="animation-delay: 0.4s;">
                ¬© 2024 Ëá¥ÊàëÁöÑ‰πñ‰πñ - ‰∏ìÂ±ûÁà±ÊÉÖÁ∫™ÂøµÂÜå | Áî®ÂøÉËÆ∞ÂΩïÊØè‰∏ÄÂàª
            </div>
        </div>
    </footer>

    <script src="leancloud-proxy.js"></script>
    <script>
        // LeanCloudÈÖçÁΩÆ - ËØ∑Âú®ËøôÈáåÂ°´ÂÜôÊÇ®ÁöÑLeanCloud App IDÂíåApp Key
        const LEANCLOUD_CONFIG = {
            appId: 'vlZDZ6PfwrEFBqML5gsoIoZR-gzGzoHsz',
            appKey: 'fBjE3MOUBxa5WW1FliybA7xx',
            serverURL: 'https://vlzdz6pf.lc-cn-n1-shared.com'
        };

        // ÂÖ®Â±ÄÂèòÈáè
        let loveStartDate = null;
        let yourName = 'Êàë';
        let partnerName = '‰πñ‰πñ';
        let timerInterval = null;
        let isTimerRunning = false;
        let isTimerPaused = false;
        let timerOffset = 0;
        let dataSync = null;

        // ÂàùÂßãÂåñÂ∫îÁî®
        document.addEventListener('DOMContentLoaded', function() {
            initializeLoveParticles();
            initializeDataSync();
            loadSettings();
            checkTimerStatus();
            loadAllData();
            showNotification('Ê¨¢ËøéÊù•Âà∞Êàë‰ª¨ÁöÑÁà±ÊÉÖÂ∞èÁ´ôÔºÅ', 'success');
            
            // ÂàùÂßãÂåñÊó•ÊúüÈÄâÊã©Âô®‰∏∫‰ªäÂ§©
            if (document.getElementById('diaryDate')) {
                document.getElementById('diaryDate').value = new Date().toISOString().split('T')[0];
            }
            if (document.getElementById('anniversaryDate')) {
                document.getElementById('anniversaryDate').value = new Date().toISOString().split('T')[0];
            }
        });

        // ÂàùÂßãÂåñÊï∞ÊçÆÂêåÊ≠•
        function initializeDataSync() {
            try {
                // Ê£ÄÊü•ÊòØÂê¶ÈÖçÁΩÆ‰∫ÜLeanCloud
                if (!LEANCLOUD_CONFIG.appId || !LEANCLOUD_CONFIG.appKey) {
                    showNotification('ËØ∑ÂÖàÈÖçÁΩÆLeanCloud App IDÂíåApp KeyÔºÅ', 'error');
                    return;
                }

                dataSync = new LoveSiteDataSync(LEANCLOUD_CONFIG);
                dataSync.init();

                // ËÆæÁΩÆÊï∞ÊçÆÊõ¥Êñ∞ÁõëÂê¨Âô®
                dataSync.onDataUpdated((type, data) => {
                    console.log(`Data updated: ${type}`, data);
                    updateUIForDataType(type, data);
                });

            } catch (error) {
                console.error('Failed to initialize data sync:', error);
                showNotification('Êï∞ÊçÆÂêåÊ≠•ÂàùÂßãÂåñÂ§±Ë¥•', 'error');
            }
        }

        // ÂêåÊ≠•ÊâÄÊúâÊï∞ÊçÆ
        function syncAllData() {
            if (!dataSync) {
                showNotification('Êï∞ÊçÆÂêåÊ≠•ÊúçÂä°Êú™ÂàùÂßãÂåñ', 'error');
                return;
            }

            // ÊòæÁ§∫ÂêåÊ≠•‰∏≠Áä∂ÊÄÅ
            const syncBadge = document.getElementById('syncBadge');
            if (syncBadge) {
                syncBadge.classList.remove('hidden', 'bg-green-500');
                syncBadge.classList.add('bg-yellow-500');
                syncBadge.textContent = '...';
            }

            dataSync.syncAllData().then(success => {
                // Êõ¥Êñ∞ÂêåÊ≠•Áä∂ÊÄÅ
                if (syncBadge) {
                    if (success) {
                        syncBadge.classList.remove('bg-yellow-500');
                        syncBadge.classList.add('bg-green-500');
                        syncBadge.textContent = '‚úì';
                        
                        // 3ÁßíÂêéÈöêËóèÊàêÂäüÊ†áÂøó
                        setTimeout(() => {
                            syncBadge.classList.add('hidden');
                        }, 3000);
                    } else {
                        syncBadge.classList.remove('bg-yellow-500');
                        syncBadge.classList.add('bg-red-500');
                        syncBadge.textContent = '‚úó';
                    }
                }
            });
        }

        // Âä†ËΩΩÊâÄÊúâÊï∞ÊçÆ
        function loadAllData() {
            loadPhotos();
            loadDiary();
            loadMessages();
            loadAnniversaries();
        }

        // Ê†πÊçÆÊï∞ÊçÆÁ±ªÂûãÊõ¥Êñ∞UI
        function updateUIForDataType(type, data) {
            switch (type) {
                case 'Photo':
                    renderPhotos(data);
                    break;
                case 'Diary':
                    renderDiary(data);
                    break;
                case 'Message':
                    renderMessages(data);
                    break;
                case 'Anniversary':
                    renderAnniversaries(data);
                    break;
                case 'Setting':
                    loadSettings();
                    break;
            }
        }

        // ÂàùÂßãÂåñÁà±ÊÉÖÁ≤íÂ≠êÊïàÊûú
        function initializeLoveParticles() {
            const particles = document.getElementById('loveParticles');
            if (!particles) return;

            // ÂàõÂª∫ÈöèÊú∫ÊµÆÂä®ÁöÑÁà±ÂøÉÁ≤íÂ≠ê
            for (let i = 0; i < 15; i++) {
                setTimeout(() => {
                    createFloatingParticle();
                }, i * 1000);
            }

            // ÂÆöÊúüÂàõÂª∫Êñ∞Á≤íÂ≠ê
            setInterval(createFloatingParticle, 3000);
        }

        // ÂàõÂª∫ÊµÆÂä®Á≤íÂ≠ê
        function createFloatingParticle() {
            const particles = document.getElementById('loveParticles');
            if (!particles) return;

            const particle = document.createElement('div');
            const hearts = ['üíï', 'üíñ', 'üíò', 'üíù', 'üíì', 'üíó', 'üíû', 'üíå', 'üíü'];
            particle.textContent = hearts[Math.floor(Math.random() * hearts.length)];
            
            const size = Math.random() * 20 + 10;
            const left = Math.random() * 100;
            const top = Math.random() * 100;
            const duration = Math.random() * 10 + 10;
            const delay = Math.random() * 5;
            const opacity = Math.random() * 0.6 + 0.2;

            particle.style.cssText = `
                position: absolute;
                left: ${left}%;
                top: ${top}%;
                font-size: ${size}px;
                opacity: ${opacity};
                pointer-events: none;
                animation: float ${duration}s ease-in-out infinite;
                animation-delay: ${delay}s;
                z-index: 1000;
            `;

            particles.appendChild(particle);

            // Ëá™Âä®ÁßªÈô§
            setTimeout(() => {
                if (particle.parentNode) {
                    particle.style.opacity = '0';
                    particle.style.transition = 'opacity 2s ease-out';
                    setTimeout(() => {
                        if (particle.parentNode) {
                            particle.parentNode.removeChild(particle);
                        }
                    }, 2000);
                }
            }, duration * 1000);
        }

        // Ê£ÄÊü•ËÆ°Êó∂Âô®Áä∂ÊÄÅ
        function checkTimerStatus() {
            const savedSettings = localStorage.getItem('loveSiteSettings');
            if (savedSettings) {
                try {
                    const settings = JSON.parse(savedSettings);
                    if (settings.loveStartDate) {
                        const savedDate = new Date(settings.loveStartDate);
                        const now = new Date();
                        
                        // Ê£ÄÊü•Êó•ÊúüÊòØÂê¶ÊúâÊïà‰∏î‰∏çÊòØÊú™Êù•Êó•Êúü
                        if (!isNaN(savedDate.getTime()) && savedDate <= now) {
                            loveStartDate = savedDate;
                            isTimerRunning = true;
                            showTimerSection();
                            startTimer();
                        } else {
                            // Êó•ÊúüÊó†ÊïàÊàñ‰∏∫Êú™Êù•Êó•ÊúüÔºåÊòæÁ§∫Ë°®ÁôΩÁïåÈù¢
                            showProposalSection();
                        }
                    } else {
                        showProposalSection();
                    }
                } catch (error) {
                    console.error('Failed to parse settings:', error);
                    showProposalSection();
                }
            } else {
                showProposalSection();
            }
        }

        // ÊòæÁ§∫Ë°®ÁôΩÂå∫Âüü
        function showProposalSection() {
            const proposalSection = document.getElementById('proposalSection');
            const timerSection = document.getElementById('timerSection');
            
            if (proposalSection) proposalSection.classList.remove('hidden');
            if (timerSection) timerSection.classList.add('hidden');
        }

        // ÊòæÁ§∫ËÆ°Êó∂Âô®Âå∫Âüü
        function showTimerSection() {
            const proposalSection = document.getElementById('proposalSection');
            const timerSection = document.getElementById('timerSection');
            
            if (proposalSection) proposalSection.classList.add('hidden');
            if (timerSection) timerSection.classList.remove('hidden');
        }

        // ÂºÄÂßãÁà±ÊÉÖËÆ°Êó∂Âô®ÔºàË°®ÁôΩÂäüËÉΩÔºâ
        function startLoveTimer() {
            // ËÆæÁΩÆÂΩìÂâçÊó∂Èó¥‰∏∫ÊÅãÁà±ÂºÄÂßãÊó∂Èó¥
            loveStartDate = new Date();
            timerOffset = 0;
            
            // ‰øùÂ≠òËÆæÁΩÆ
            const settings = {
                loveStartDate: loveStartDate.toISOString(),
                yourName: yourName,
                partnerName: partnerName
            };
            localStorage.setItem('loveSiteSettings', JSON.stringify(settings));
            
            // ÂêåÊó∂‰øùÂ≠òÂà∞‰∫ëÁ´Ø
            if (dataSync) {
                dataSync.addItem('Setting', settings);
            }
            
            // Êõ¥Êñ∞Áä∂ÊÄÅ
            isTimerRunning = true;
            isTimerPaused = false;
            
            // ÊòæÁ§∫Êµ™Êº´Âä®Áîª
            showRomanticAnimation();
            
            // ÂàáÊç¢Âà∞ËÆ°Êó∂Âô®ÊòæÁ§∫
            setTimeout(() => {
                showTimerSection();
                startTimer();
                showNotification('ÊÅ≠ÂñúÔºÅ‰Ω†‰ª¨ÁöÑÁà±ÊÉÖËÆ°Êó∂Âô®Â∑≤ÂºÄÂßãÔºÅ', 'success');
            }, 2000);
        }

        // ÊòæÁ§∫Êµ™Êº´Âä®Áîª
        function showRomanticAnimation() {
            // ÂàõÂª∫Â∫ÜÁ•ùÊïàÊûú
            for (let i = 0; i < 30; i++) {
                setTimeout(() => {
                    createHeartParticle();
                }, i * 80);
            }
            
            // ÂàõÂª∫ÁàÜÁÇ∏Áà±ÂøÉÊïàÊûú
            const heart = document.createElement('div');
            heart.className = 'fixed top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 text-8xl animate-heartExplosion z-50';
            heart.textContent = 'üíï';
            document.body.appendChild(heart);
            
            setTimeout(() => {
                if (heart.parentNode) {
                    heart.parentNode.removeChild(heart);
                }
            }, 1000);
            
            // Ê∑ªÂä†ÊñáÂ≠óÂä®Áîª
            const text = document.createElement('div');
            text.className = 'fixed top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 text-4xl md:text-6xl font-bold text-white animate-fadeInUp z-50 text-center';
            text.textContent = '‚ù§Ô∏è ÊàëÁà±‰Ω†Ôºå‰πñ‰πñÔºÅ‚ù§Ô∏è';
            text.style.textShadow = '0 0 30px rgba(255, 107, 157, 0.9)';
            text.style.animationDuration = '1s';
            document.body.appendChild(text);
            
            setTimeout(() => {
                text.style.opacity = '0';
                text.style.transition = 'opacity 1s ease-out';
                setTimeout(() => {
                    if (text.parentNode) {
                        text.parentNode.removeChild(text);
                    }
                }, 1000);
            }, 2000);
            
            // ÂàõÂª∫3DÊóãËΩ¨ÊïàÊûú
            const rotateHeart = document.createElement('div');
            rotateHeart.className = 'fixed top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 text-6xl animate-rotate3d z-40 opacity-70';
            rotateHeart.textContent = 'üíû';
            document.body.appendChild(rotateHeart);
            
            setTimeout(() => {
                if (rotateHeart.parentNode) {
                    rotateHeart.parentNode.removeChild(rotateHeart);
                }
            }, 3000);
        }

        // ÂàõÂª∫Áà±ÂøÉÁ≤íÂ≠ê
        function createHeartParticle() {
            const particle = document.createElement('div');
            particle.className = 'fixed text-2xl animate-float z-50';
            particle.textContent = ['üíï', 'üíñ', 'üíò', 'üíù', 'üíì', 'üíó', 'üíû', 'üíå'][Math.floor(Math.random() * 8)];
            
            // ÈöèÊú∫‰ΩçÁΩÆÂíåÂä®Áîª
            const size = Math.random() * 20 + 10;
            const left = Math.random() * 100;
            const top = Math.random() * 100;
            const delay = Math.random() * 3;
            const duration = Math.random() * 4 + 4;
            
            particle.style.left = left + '%';
            particle.style.top = top + '%';
            particle.style.fontSize = size + 'px';
            particle.style.animationDelay = delay + 's';
            particle.style.animationDuration = duration + 's';
            particle.style.opacity = '0.8';
            
            document.body.appendChild(particle);
            
            // Ëá™Âä®ÁßªÈô§
            setTimeout(() => {
                if (particle.parentNode) {
                    particle.style.opacity = '0';
                    particle.style.transition = 'opacity 1s ease-out';
                    setTimeout(() => {
                        if (particle.parentNode) {
                            particle.parentNode.removeChild(particle);
                        }
                    }, 1000);
                }
            }, duration * 1000);
        }

        // Âä†ËΩΩËÆæÁΩÆ
        function loadSettings() {
            const savedSettings = localStorage.getItem('loveSiteSettings');
            if (savedSettings) {
                try {
                    const settings = JSON.parse(savedSettings);
                    if (settings.loveStartDate) {
                        loveStartDate = new Date(settings.loveStartDate);
                    }
                    yourName = settings.yourName || 'Êàë';
                    partnerName = settings.partnerName || '‰πñ‰πñ';
                } catch (error) {
                    console.error('Failed to load settings:', error);
                }
            }

            // ‰ªé‰∫ëÁ´ØÂä†ËΩΩÊúÄÊñ∞ËÆæÁΩÆ
            if (dataSync) {
                const settings = dataSync.getData('Setting');
                if (settings && settings.length > 0) {
                    const latestSettings = settings[0];
                    if (latestSettings.loveStartDate) {
                        loveStartDate = new Date(latestSettings.loveStartDate);
                    }
                    yourName = latestSettings.yourName || yourName;
                    partnerName = latestSettings.partnerName || partnerName;
                }
            }
        }

        // ÂºÄÂßãËÆ°Êó∂Âô®
        function startTimer() {
            if (!isTimerRunning || !loveStartDate || isTimerPaused) return;
            
            stopTimer(); // ÂÖàÂÅúÊ≠¢Áé∞ÊúâËÆ°Êó∂Âô®
            updateLoveTimer();
            timerInterval = setInterval(updateLoveTimer, 1000);
        }

        // ÂÅúÊ≠¢ËÆ°Êó∂Âô®
        function stopTimer() {
            if (timerInterval) {
                clearInterval(timerInterval);
                timerInterval = null;
            }
        }

        // ÊöÇÂÅúËÆ°Êó∂Âô®
        function pauseTimer() {
            if (isTimerRunning && !isTimerPaused) {
                isTimerPaused = true;
                stopTimer();
                
                // Êõ¥Êñ∞ÊåâÈíÆÊòæÁ§∫
                const pauseBtn = document.getElementById('pauseBtn');
                const resumeBtn = document.getElementById('resumeBtn');
                if (pauseBtn) pauseBtn.classList.add('hidden');
                if (resumeBtn) resumeBtn.classList.remove('hidden');
                
                showNotification('ËÆ°Êó∂Âô®Â∑≤ÊöÇÂÅú', 'info');
            }
        }

        // ÁªßÁª≠ËÆ°Êó∂Âô®
        function resumeTimer() {
            if (isTimerRunning && isTimerPaused) {
                isTimerPaused = false;
                startTimer();
                
                // Êõ¥Êñ∞ÊåâÈíÆÊòæÁ§∫
                const pauseBtn = document.getElementById('pauseBtn');
                const resumeBtn = document.getElementById('resumeBtn');
                if (pauseBtn) pauseBtn.classList.remove('hidden');
                if (resumeBtn) resumeBtn.classList.add('hidden');
                
                showNotification('ËÆ°Êó∂Âô®Â∑≤ÁªßÁª≠', 'success');
            }
        }

        // ÈáçÁΩÆËÆ°Êó∂Âô®
        function resetTimer() {
            if (confirm('Á°ÆÂÆöË¶ÅÈáçÁΩÆËÆ°Êó∂Âô®ÂêóÔºüËøôÂ∞ÜÊ∏ÖÈô§ÂΩìÂâçËÆ°Êó∂ËÆ∞ÂΩïÔºÅ')) {
                isTimerRunning = false;
                isTimerPaused = false;
                timerOffset = 0;
                stopTimer();
                
                // Ê∏ÖÈô§‰øùÂ≠òÁöÑÊó•Êúü
                const settings = {
                    loveStartDate: null,
                    yourName: yourName,
                    partnerName: partnerName
                };
                localStorage.setItem('loveSiteSettings', JSON.stringify(settings));
                
                // ÂêåÊó∂Êõ¥Êñ∞‰∫ëÁ´Ø
                if (dataSync) {
                    dataSync.addItem('Setting', settings);
                }
                
                showProposalSection();
                showNotification('ËÆ°Êó∂Âô®Â∑≤ÈáçÁΩÆÔºåËØ∑ÈáçÊñ∞ÂºÄÂßãÔºÅ', 'info');
            }
        }

        // Êõ¥Êñ∞Áà±ÊÉÖËÆ°Êó∂Âô®
        function updateLoveTimer() {
            if (!loveStartDate || isTimerPaused) return;
            
            const now = new Date();
            const diff = now - loveStartDate + timerOffset;
            
            if (diff < 0) {
                // Â¶ÇÊûúÊó•ÊúüÊó†ÊïàÔºåÊòæÁ§∫ÈîôËØØ‰ø°ÊÅØ
                if (document.getElementById('days')) {
                    document.getElementById('days').textContent = '‚ùå';
                    document.getElementById('hours').textContent = '‚ùå';
                    document.getElementById('minutes').textContent = '‚ùå';
                    document.getElementById('seconds').textContent = '‚ùå';
                    document.getElementById('sunriseCount').textContent = '‚ùå';
                    document.getElementById('sunsetCount').textContent = '‚ùå';
                }
                return;
            }
            
            const days = Math.floor(diff / (1000 * 60 * 60 * 24));
            const hours = Math.floor((diff % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
            const minutes = Math.floor((diff % (1000 * 60 * 60)) / (1000 * 60));
            const seconds = Math.floor((diff % (1000 * 60)) / 1000);
            
            if (document.getElementById('days')) {
                document.getElementById('days').textContent = days.toLocaleString();
                document.getElementById('hours').textContent = hours.toString().padStart(2, '0');
                document.getElementById('minutes').textContent = minutes.toString().padStart(2, '0');
                document.getElementById('seconds').textContent = seconds.toString().padStart(2, '0');
                
                // Êõ¥Êñ∞Êó•Âá∫Êó•ËêΩËÆ°Êï∞
                document.getElementById('sunriseCount').textContent = days.toLocaleString();
                document.getElementById('sunsetCount').textContent = days.toLocaleString();
            }
        }

        // ÁÖßÁâáÁõ∏ÂÖ≥ÂäüËÉΩ
        function loadPhotos() {
            if (dataSync) {
                const photos = dataSync.getData('Photo');
                renderPhotos(photos);
            } else {
                // ‰ªéÊú¨Âú∞Â≠òÂÇ®Âä†ËΩΩ
                const photos = loadDataFromStorage('Photo');
                if (photos.length === 0) {
                    // Âä†ËΩΩÈªòËÆ§ÁÖßÁâá
                    const defaultPhotos = [
                        {
                            url: 'https://doc.doubao.com/s/szwHoikLiug/',
                            title: 'Á¨¨‰∏ÄÊ¨°ÁâµÊâã',
                            description: 'Âú®ÈÇ£‰∏™Èò≥ÂÖâÊòéÂ™öÁöÑÂçàÂêé'
                        },
                        {
                            url: 'https://doc.doubao.com/s/tTEhEFPcRBY/',
                            title: 'Êµ∑ËæπÊº´Ê≠•',
                            description: 'Âê¨ÁùÄÊµ∑Êµ™Â£∞ÔºåÊÑüÂèóÂΩºÊ≠§ÁöÑÂøÉË∑≥'
                        },
                        {
                            url: 'https://doc.doubao.com/s/ts-a_I7kjl4/',
                            title: 'Ê∏©È¶®Êó∂ÂÖâ',
                            description: 'ÊúÄÁÆÄÂçïÁöÑÂπ∏Á¶èÂ∞±ÊòØÂíå‰Ω†Âú®‰∏ÄËµ∑'
                        },
                        {
                            url: 'https://doc.doubao.com/s/uExmwHw7_Mk/',
                            title: 'Áà±ÁöÑÊã•Êä±',
                            description: 'Âú®‰Ω†ÊÄÄÈáåÔºåÊàëÊâæÂà∞‰∫ÜÂÖ®‰∏ñÁïå'
                        },
                        {
                            url: 'https://doc.doubao.com/s/HQNB-FL5R7M/',
                            title: 'Êµ™Êº´ÁÉüËä±',
                            description: 'ÁÉüËä±ÂÜçÁæéÔºå‰πüÊØî‰∏ç‰∏ä‰Ω†ÁöÑÁ¨ëÂÆπ'
                        },
                        {
                            url: 'https://doc.doubao.com/s/HyZdiZ_DXoc/',
                            title: 'Áà±ÂøÉÁÅØÂÖâ',
                            description: 'ÊØè‰∏ÄÁõèÁÅØÈÉΩ‰ª£Ë°®ÊàëÂØπ‰Ω†ÁöÑÁà±'
                        }
                    ];
                    
                    saveDataToStorage('Photo', defaultPhotos);
                    renderPhotos(defaultPhotos);
                } else {
                    renderPhotos(photos);
                }
            }
        }

        function renderPhotos(photos) {
            const photoGrid = document.getElementById('photoGrid');
            if (!photoGrid) return;
            
            photoGrid.innerHTML = '';
            
            photos.forEach((photo, index) => {
                const photoCard = `
                    <div class="group relative overflow-hidden rounded-2xl glass-effect hover:scale-105 transition-transform duration-300 hover-lift animate-fadeInUp" style="animation-delay: ${index * 0.1}s;">
                        <img src="${photo.url}" alt="${photo.title}" class="w-full h-64 object-cover group-hover:scale-110 transition-transform duration-500">
                        <button onclick="deletePhoto('${photo.id}')" class="delete-btn absolute top-3 right-3 w-8 h-8 bg-red-500 rounded-full flex items-center justify-center text-white hover:bg-red-600 transition-colors z-10">
                            <i class="fa fa-times text-sm"></i>
                        </button>
                        <div class="absolute inset-0 bg-gradient-to-t from-black/60 to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300 flex items-end">
                            <div class="p-6 text-white">
                                <h3 class="text-xl font-semibold mb-2">${photo.title}</h3>
                                <p class="text-sm opacity-90">${photo.description}</p>
                            </div>
                        </div>
                    </div>
                `;
                photoGrid.innerHTML += photoCard;
            });
        }

        async function uploadPhotos(event) {
            const files = event.target.files;
            if (!files || files.length === 0) return;
            
            if (!dataSync) {
                showNotification('Êï∞ÊçÆÂêåÊ≠•ÊúçÂä°Êú™ÂàùÂßãÂåñ', 'error');
                return;
            }
            
            let uploadedCount = 0;
            
            Array.from(files).forEach(file => {
                if (file.type.startsWith('image/')) {
                    // ÂÖàÊòæÁ§∫Êú¨Âú∞È¢ÑËßà
                    const reader = new FileReader();
                    reader.onload = async function(e) {
                        // ÊòæÁ§∫‰∏ä‰º†‰∏≠Áä∂ÊÄÅ
                        showNotification(`Ê≠£Âú®‰∏ä‰º†ÁÖßÁâá ${uploadedCount + 1}/${files.length}...`, 'info');
                        
                        // ‰∏ä‰º†Âà∞LeanCloud
                        const uploadResult = await dataSync.uploadFile(file, file.name);
                        
                        if (uploadResult) {
                            const newPhoto = {
                                url: uploadResult.url,
                                title: 'Êñ∞ÁÖßÁâá',
                                description: 'ÁæéÂ•ΩÁöÑÂõûÂøÜ',
                                timestamp: new Date().toISOString(),
                                fileName: file.name,
                                fileSize: file.size
                            };
                            
                            // Ê∑ªÂä†Âà∞Êï∞ÊçÆÂ∫ì
                            const savedPhoto = await dataSync.addItem('Photo', newPhoto);
                            
                            if (savedPhoto) {
                                uploadedCount++;
                                showNotification(`ÁÖßÁâá ${uploadedCount}/${files.length} ‰∏ä‰º†ÊàêÂäüÔºÅ`, 'success');
                            }
                        }
                        
                        if (uploadedCount === files.length) {
                            showNotification(`ÊàêÂäü‰∏ä‰º† ${uploadedCount} Âº†ÁÖßÁâáÔºÅ`, 'success');
                        }
                    };
                    reader.onerror = function() {
                        showNotification('ÁÖßÁâá‰∏ä‰º†Â§±Ë¥•ÔºåËØ∑ÈáçËØïÔºÅ', 'error');
                    };
                    reader.readAsDataURL(file);
                }
            });
        }

        async function deletePhoto(id) {
            if (!dataSync) {
                showNotification('Êï∞ÊçÆÂêåÊ≠•ÊúçÂä°Êú™ÂàùÂßãÂåñ', 'error');
                return;
            }
            
            if (confirm('Á°ÆÂÆöË¶ÅÂà†Èô§ËøôÂº†ÁÖßÁâáÂêóÔºü')) {
                const success = await dataSync.deleteItem('Photo', id);
                if (success) {
                    showNotification('ÁÖßÁâáÂà†Èô§ÊàêÂäüÔºÅ', 'success');
                }
            }
        }

        // Êó•ËÆ∞Áõ∏ÂÖ≥ÂäüËÉΩ
        function loadDiary() {
            if (dataSync) {
                const diaryEntries = dataSync.getData('Diary');
                renderDiary(diaryEntries);
            } else {
                // ‰ªéÊú¨Âú∞Â≠òÂÇ®Âä†ËΩΩ
                const diaryEntries = loadDataFromStorage('Diary');
                if (diaryEntries.length === 0) {
                    // Âä†ËΩΩÈªòËÆ§Êó•ËÆ∞
                    const defaultDiary = [
                        {
                            title: 'Á¨¨‰∏ÄÊ¨°Áõ∏ÈÅá',
                            date: '2024-01-15',
                            content: `ËÆ∞ÂæóÈÇ£ÊòØ‰∏Ä‰∏™ÂØíÂÜ∑ÁöÑÂÜ¨Êó•ÂçàÂêéÔºåÊàëÂú®ÂíñÂï°È¶ÜÈáåÁ¨¨‰∏ÄÊ¨°ËßÅÂà∞‰∫Ü${partnerName}„ÄÇ‰Ω†Á©øÁùÄÁôΩËâ≤ÁöÑÊØõË°£ÔºåÈò≥ÂÖâÈÄèËøáÁ™óÊà∑Ê¥íÂú®‰Ω†Ë∫´‰∏äÔºåÈÇ£‰∏ÄÂàªÊàë‰ªø‰ΩõÁúãÂà∞‰∫ÜÂ§©‰Ωø„ÄÇÊàë‰ª¨ËÅä‰∫ÜÊï¥Êï¥‰∏Ä‰∏ãÂçàÔºå‰ªéÂÖ¥Ë∂£Áà±Â•ΩÂà∞‰∫∫ÁîüÁêÜÊÉ≥ÔºåÊÑüËßâÂ∞±ÂÉèËÆ§ËØÜ‰∫ÜÂæà‰πÖÂæà‰πÖ...`
                        },
                        {
                            title: 'Á¨¨‰∏ÄÊ¨°Á∫¶‰ºö',
                            date: '2024-02-14',
                            content: `ÊÉÖ‰∫∫ËäÇÈÇ£Â§©ÔºåÊàëÈºìË∂≥ÂãáÊ∞îÁ∫¶${partnerName}Âá∫Êù•„ÄÇÊàë‰ª¨ÂéªÁúã‰∫Ü‰∏ÄÂú∫Êµ™Êº´ÁöÑÁîµÂΩ±ÔºåÁÑ∂ÂêéÂú®Ê≤≥ËæπÊï£Ê≠•„ÄÇÂΩìÊàëÁâµËµ∑‰Ω†ÁöÑÊâãÊó∂ÔºåÊàëÁöÑÂøÉË∑≥ÂæóÂ•ΩÂø´„ÄÇ‰Ω†ÂëäËØâÊàëÔºå‰Ω†‰πüÂñúÊ¨¢ÊàëÂæà‰πÖ‰∫Ü„ÄÇÈÇ£‰∏ÄÂàªÔºåÊàëËßâÂæóÊï¥‰∏™‰∏ñÁïåÈÉΩÂèòÂæóÁæéÂ•ΩËµ∑Êù•...`
                        }
                    ];
                    
                    saveDataToStorage('Diary', defaultDiary);
                    renderDiary(defaultDiary);
                } else {
                    renderDiary(diaryEntries);
                }
            }
        }

        function renderDiary(entries) {
            const diaryList = document.getElementById('diaryList');
            if (!diaryList) return;
            
            diaryList.innerHTML = '';
            
            entries.forEach((entry, index) => {
                const diaryCard = `
                    <div class="glass-effect rounded-3xl p-8 hover-lift animate-fadeInUp" style="animation-delay: ${index * 0.1}s;">
                        <div class="flex justify-between items-start mb-4">
                            <div class="flex items-center space-x-2">
                                <h3 class="text-xl font-semibold text-white">${entry.title}</h3>
                                <span class="text-sm text-white/60 font-elegant">${entry.date}</span>
                            </div>
                            <button onclick="deleteDiary('${entry.id}')" class="delete-btn w-8 h-8 bg-red-500 rounded-full flex items-center justify-center text-white hover:bg-red-600 transition-colors">
                                <i class="fa fa-times text-sm"></i>
                            </button>
                        </div>
                        <p class="text-white/80 leading-relaxed font-elegant mb-4">${entry.content}</p>
                        <div class="flex items-center space-x-6 text-sm text-white/60">
                            <span><i class="fa fa-heart mr-1 text-love-300"></i>Ê∞∏ËøúÈöæÂøò</span>
                            <span><i class="fa fa-star mr-1 text-love-300"></i>ÁæéÂ•ΩÂõûÂøÜ</span>
                        </div>
                    </div>
                `;
                diaryList.innerHTML += diaryCard;
            });
        }

        function showAddDiaryModal() {
            const modal = document.getElementById('addDiaryModal');
            if (modal) {
                modal.classList.remove('hidden');
                // ËÆæÁΩÆÈªòËÆ§Êó•Êúü‰∏∫‰ªäÂ§©
                const diaryDate = document.getElementById('diaryDate');
                if (diaryDate) {
                    diaryDate.value = new Date().toISOString().split('T')[0];
                }
            }
        }

        function hideAddDiaryModal() {
            const modal = document.getElementById('addDiaryModal');
            if (modal) {
                modal.classList.add('hidden');
            }
        }

        async function addDiary() {
            const titleInput = document.getElementById('diaryTitle');
            const dateInput = document.getElementById('diaryDate');
            const contentInput = document.getElementById('diaryContent');
            
            if (!titleInput || !dateInput || !contentInput) return;
            
            const title = titleInput.value.trim();
            const date = dateInput.value;
            const content = contentInput.value.trim();
            
            if (title && date && content) {
                if (!dataSync) {
                    showNotification('Êï∞ÊçÆÂêåÊ≠•ÊúçÂä°Êú™ÂàùÂßãÂåñ', 'error');
                    return;
                }
                
                const newEntry = { 
                    title, 
                    date, 
                    content,
                    author: yourName
                };
                
                const savedEntry = await dataSync.addItem('Diary', newEntry);
                
                if (savedEntry) {
                    hideAddDiaryModal();
                    titleInput.value = '';
                    contentInput.value = '';
                    showNotification('Êó•ËÆ∞Ê∑ªÂä†ÊàêÂäüÔºÅ', 'success');
                }
            } else {
                showNotification('ËØ∑Â°´ÂÜôÂÆåÊï¥ÁöÑÊó•ËÆ∞‰ø°ÊÅØÔºÅ', 'error');
            }
        }

        async function deleteDiary(id) {
            if (!dataSync) {
                showNotification('Êï∞ÊçÆÂêåÊ≠•ÊúçÂä°Êú™ÂàùÂßãÂåñ', 'error');
                return;
            }
            
            if (confirm('Á°ÆÂÆöË¶ÅÂà†Èô§ËøôÁØáÊó•ËÆ∞ÂêóÔºü')) {
                const success = await dataSync.deleteItem('Diary', id);
                if (success) {
                    showNotification('Êó•ËÆ∞Âà†Èô§ÊàêÂäüÔºÅ', 'success');
                }
            }
        }

        // ÁïôË®ÄÁõ∏ÂÖ≥ÂäüËÉΩ
        function loadMessages() {
            if (dataSync) {
                const messages = dataSync.getData('Message');
                renderMessages(messages);
            } else {
                // ‰ªéÊú¨Âú∞Â≠òÂÇ®Âä†ËΩΩ
                const messages = loadDataFromStorage('Message');
                if (messages.length === 0) {
                    // Âä†ËΩΩÈªòËÆ§ÁïôË®Ä
                    const defaultMessages = [
                        {
                            sender: partnerName,
                            content: `‰∫≤Áà±ÁöÑ${yourName}Ôºå‰ªäÂ§©‰πüË∂ÖÁ∫ßÁà±‰Ω†ÔºÅ‰Ω†ÊòØÊàëÁîüÂëΩ‰∏≠ÊúÄÁæéÁöÑÈò≥ÂÖâÔºåÊúâ‰Ω†Âú®Ë∫´ËæπÊØèÂ§©ÈÉΩÂÖÖÊª°Ê∏©Êöñ„ÄÇ`,
                            timestamp: new Date().toISOString()
                        },
                        {
                            sender: yourName,
                            content: `Ë∞¢Ë∞¢‰Ω†Êù•Âà∞ÊàëÁöÑÁîüÂëΩ‰∏≠ÔºåËÆ©ÊàëÁü•ÈÅì‰ªÄ‰πàÊòØÁúüÊ≠£ÁöÑÂπ∏Á¶è„ÄÇÊó†ËÆ∫ÈÅáÂà∞‰ªÄ‰πàÂõ∞ÈöæÔºåÊàë‰ª¨ÈÉΩË¶Å‰∏ÄËµ∑Èù¢ÂØπÔºåÊ∞∏Ëøú‰∏çÂàÜÁ¶ª„ÄÇ`,
                            timestamp: new Date(Date.now() - 86400000).toISOString()
                        }
                    ];
                    
                    saveDataToStorage('Message', defaultMessages);
                    renderMessages(defaultMessages);
                } else {
                    renderMessages(messages);
                }
            }
        }

        function renderMessages(messages) {
            const messageList = document.getElementById('messageList');
            if (!messageList) return;
            
            messageList.innerHTML = '';
            
            messages.forEach((message, index) => {
                try {
                    const date = new Date(message.createdAt || message.timestamp);
                    const timeString = date.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });
                    const dateString = date.toLocaleDateString([], { month: 'short', day: 'numeric' });
                    
                    const isCurrentUser = message.sender === yourName;
                    const messageCard = `
                        <div class="glass-effect rounded-3xl p-6 hover-lift animate-fadeInUp" style="animation-delay: ${index * 0.1}s; ${isCurrentUser ? 'border-l-4 border-love-300' : 'border-r-4 border-blue-300'}">
                            <div class="flex justify-between items-start mb-2">
                                <div class="flex items-center space-x-2">
                                    <span class="font-semibold text-white">${message.sender}</span>
                                    <span class="text-xs text-white/60 font-elegant">${dateString} ${timeString}</span>
                                </div>
                                <button onclick="deleteMessage('${message.id}')" class="delete-btn w-8 h-8 bg-red-500 rounded-full flex items-center justify-center text-white hover:bg-red-600 transition-colors">
                                    <i class="fa fa-times text-sm"></i>
                                </button>
                            </div>
                            <p class="text-white/80 leading-relaxed font-elegant mb-3">${message.content}</p>
                            <div class="flex items-center space-x-4 text-sm">
                                <button onclick="likeMessage('${message.id}')" class="text-love-300 hover:text-love-200 transition-colors hover:scale-110 transition-transform">
                                    <i class="fa fa-heart mr-1"></i>ÂñúÊ¨¢
                                </button>
                                <button onclick="replyToMessage('${message.id}')" class="text-white/60 hover:text-white transition-colors hover:scale-110 transition-transform">
                                    <i class="fa fa-reply mr-1"></i>ÂõûÂ§ç
                                </button>
                            </div>
                        </div>
                    `;
                    messageList.innerHTML += messageCard;
                } catch (error) {
                    console.error('Failed to render message:', error);
                }
            });
        }

        async function addMessage() {
            const messageInput = document.getElementById('messageInput');
            if (!messageInput) return;
            
            const content = messageInput.value.trim();
            
            if (content) {
                if (!dataSync) {
                    showNotification('Êï∞ÊçÆÂêåÊ≠•ÊúçÂä°Êú™ÂàùÂßãÂåñ', 'error');
                    return;
                }
                
                const newMessage = {
                    sender: yourName,
                    content: content,
                    timestamp: new Date().toISOString()
                };
                
                const savedMessage = await dataSync.addItem('Message', newMessage);
                
                if (savedMessage) {
                    messageInput.value = '';
                    
                    // Ê∑ªÂä†ÂèëÈÄÅÂä®Áîª
                    createSendAnimation();
                    
                    showNotification('ÁïôË®ÄÂèëÈÄÅÊàêÂäüÔºÅ', 'success');
                }
            } else {
                showNotification('ËØ∑ËæìÂÖ•ÁïôË®ÄÂÜÖÂÆπÔºÅ', 'error');
            }
        }

        // ÂàõÂª∫ÂèëÈÄÅÂä®Áîª
        function createSendAnimation() {
            const messageList = document.getElementById('messageList');
            if (!messageList) return;
            
            const animation = document.createElement('div');
            animation.className = 'fixed bottom-20 right-20 text-4xl animate-scaleIn z-50';
            animation.textContent = 'üíå';
            document.body.appendChild(animation);
            
            setTimeout(() => {
                animation.style.opacity = '0';
                animation.style.transition = 'opacity 1s ease-out';
                setTimeout(() => {
                    if (animation.parentNode) {
                        animation.parentNode.removeChild(animation);
                    }
                }, 1000);
            }, 2000);
        }

        async function deleteMessage(id) {
            if (!dataSync) {
                showNotification('Êï∞ÊçÆÂêåÊ≠•ÊúçÂä°Êú™ÂàùÂßãÂåñ', 'error');
                return;
            }
            
            if (confirm('Á°ÆÂÆöË¶ÅÂà†Èô§ËøôÊù°ÁïôË®ÄÂêóÔºü')) {
                const success = await dataSync.deleteItem('Message', id);
                if (success) {
                    showNotification('ÁïôË®ÄÂà†Èô§ÊàêÂäüÔºÅ', 'success');
                }
            }
        }

        async function likeMessage(id) {
            if (!dataSync) {
                showNotification('Êï∞ÊçÆÂêåÊ≠•ÊúçÂä°Êú™ÂàùÂßãÂåñ', 'error');
                return;
            }
            
            const messages = dataSync.getData('Message');
            const message = messages.find(m => m.id === id);
            
            if (message) {
                const updatedMessage = {
                    ...message,
                    liked: !message.liked,
                    likeCount: (message.likeCount || 0) + (message.liked ? -1 : 1)
                };
                
                await dataSync.updateItem('Message', id, updatedMessage);
                showNotification(message.liked ? 'Â∑≤ÂèñÊ∂àÁÇπËµûÔºÅ' : 'Â∑≤ÁÇπËµûÔºÅ', 'success');
            }
        }

        function replyToMessage(id) {
            const messages = dataSync ? dataSync.getData('Message') : loadDataFromStorage('Message');
            const message = messages.find(m => m.id === id);
            
            if (message) {
                const messageInput = document.getElementById('messageInput');
                if (messageInput) {
                    messageInput.value = `ÂõûÂ§ç @${message.sender}Ôºö`;
                    messageInput.focus();
                }
            }
        }

        // Á∫™ÂøµÊó•Áõ∏ÂÖ≥ÂäüËÉΩ
        function loadAnniversaries() {
            if (dataSync) {
                const anniversaries = dataSync.getData('Anniversary');
                renderAnniversaries(anniversaries);
            } else {
                // ‰ªéÊú¨Âú∞Â≠òÂÇ®Âä†ËΩΩ
                const anniversaries = loadDataFromStorage('Anniversary');
                if (anniversaries.length === 0) {
                    // Âä†ËΩΩÈªòËÆ§Á∫™ÂøµÊó•
                    const defaultAnniversaries = [
                        {
                            title: 'Áõ∏ËØÜÁ∫™ÂøµÊó•',
                            date: '2024-01-15',
                            icon: 'heart'
                        },
                        {
                            title: 'ÊÅãÁà±Á∫™ÂøµÊó•',
                            date: '2024-02-14',
                            icon: 'gift'
                        },
                        {
                            title: 'ÂàùÂêªÁ∫™ÂøµÊó•',
                            date: '2024-03-01',
                            icon: 'star'
                        },
                        {
                            title: 'Á¨¨‰∏ÄÊ¨°ÊóÖË°å',
                            date: '2024-05-20',
                            icon: 'travel'
                        },
                        {
                            title: 'Ê±ÇÂ©öÁ∫™ÂøµÊó•',
                            date: '2024-10-01',
                            icon: 'ring'
                        }
                    ];
                    
                    saveDataToStorage('Anniversary', defaultAnniversaries);
                    renderAnniversaries(defaultAnniversaries);
                } else {
                    renderAnniversaries(anniversaries);
                }
            }
        }

        function renderAnniversaries(anniversaries) {
            const anniversaryGrid = document.getElementById('anniversaryGrid');
            if (!anniversaryGrid) return;
            
            anniversaryGrid.innerHTML = '';
            
            anniversaries.forEach((anniversary, index) => {
                try {
                    const date = new Date(anniversary.date);
                    const now = new Date();
                    const diff = now - date;
                    const days = Math.floor(diff / (1000 * 60 * 60 * 24));
                    
                    const icons = {
                        heart: '‚ù§Ô∏è',
                        gift: 'üéÅ',
                        star: '‚≠ê',
                        calendar: 'üìÖ',
                        camera: 'üì∑',
                        ring: 'üíç',
                        music: 'üéµ',
                        travel: '‚úàÔ∏è'
                    };
                    
                    const anniversaryCard = `
                        <div class="glass-effect rounded-3xl p-6 text-center hover:scale-105 transition-transform duration-300 relative hover-lift animate-fadeInUp" style="animation-delay: ${index * 0.1}s;">
                            <button onclick="deleteAnniversary('${anniversary.id}')" class="delete-btn absolute top-3 right-3 w-8 h-8 bg-red-500 rounded-full flex items-center justify-center text-white hover:bg-red-600 transition-colors z-10">
                                <i class="fa fa-times text-sm"></i>
                            </button>
                            <div class="w-16 h-16 gradient-love rounded-full flex items-center justify-center mx-auto mb-4 animate-pulseGlow">
                                <span class="text-2xl">${icons[anniversary.icon] || '‚ù§Ô∏è'}</span>
                            </div>
                            <h3 class="text-xl font-semibold text-white mb-2">${anniversary.title}</h3>
                            <p class="text-white/70 font-elegant mb-4">${anniversary.date}</p>
                            <div class="text-2xl font-bold gradient-text mb-2">${days.toLocaleString()}</div>
                            <div class="text-white/60 text-sm font-elegant">Â§©Ââç</div>
                        </div>
                    `;
                    anniversaryGrid.innerHTML += anniversaryCard;
                } catch (error) {
                    console.error('Failed to render anniversary:', error);
                }
            });
        }

        function showAddAnniversaryModal() {
            const modal = document.getElementById('addAnniversaryModal');
            if (modal) {
                modal.classList.remove('hidden');
                // ËÆæÁΩÆÈªòËÆ§Êó•Êúü‰∏∫‰ªäÂ§©
                const anniversaryDate = document.getElementById('anniversaryDate');
                if (anniversaryDate) {
                    anniversaryDate.value = new Date().toISOString().split('T')[0];
                }
            }
        }

        function hideAddAnniversaryModal() {
            const modal = document.getElementById('addAnniversaryModal');
            if (modal) {
                modal.classList.add('hidden');
            }
        }

        async function addAnniversary() {
            const titleInput = document.getElementById('anniversaryTitle');
            const dateInput = document.getElementById('anniversaryDate');
            const iconSelect = document.getElementById('anniversaryIcon');
            
            if (!titleInput || !dateInput || !iconSelect) return;
            
            const title = titleInput.value.trim();
            const date = dateInput.value;
            const icon = iconSelect.value;
            
            if (title && date) {
                const selectedDate = new Date(date);
                const now = new Date();
                
                if (selectedDate <= now) {
                    if (!dataSync) {
                        showNotification('Êï∞ÊçÆÂêåÊ≠•ÊúçÂä°Êú™ÂàùÂßãÂåñ', 'error');
                        return;
                    }
                    
                    const newAnniversary = { title, date, icon };
                    
                    const savedAnniversary = await dataSync.addItem('Anniversary', newAnniversary);
                    
                    if (savedAnniversary) {
                        hideAddAnniversaryModal();
                        titleInput.value = '';
                        showNotification('Á∫™ÂøµÊó•Ê∑ªÂä†ÊàêÂäüÔºÅ', 'success');
                    }
                } else {
                    showNotification('ËØ∑ÈÄâÊã©‰ªäÂ§©ÊàñËøáÂéªÁöÑÊó•ÊúüÔºÅ', 'error');
                }
            } else {
                showNotification('ËØ∑Â°´ÂÜôÂÆåÊï¥ÁöÑÁ∫™ÂøµÊó•‰ø°ÊÅØÔºÅ', 'error');
            }
        }

        async function deleteAnniversary(id) {
            if (!dataSync) {
                showNotification('Êï∞ÊçÆÂêåÊ≠•ÊúçÂä°Êú™ÂàùÂßãÂåñ', 'error');
                return;
            }
            
            if (confirm('Á°ÆÂÆöË¶ÅÂà†Èô§Ëøô‰∏™Á∫™ÂøµÊó•ÂêóÔºü')) {
                const success = await dataSync.deleteItem('Anniversary', id);
                if (success) {
                    showNotification('Á∫™ÂøµÊó•Âà†Èô§ÊàêÂäüÔºÅ', 'success');
                }
            }
        }

        // Êú¨Âú∞Â≠òÂÇ®ËæÖÂä©ÂáΩÊï∞
        function loadDataFromStorage(type) {
            try {
                const data = localStorage.getItem(`loveSite${type}`);
                return data ? JSON.parse(data) : [];
            } catch (error) {
                console.error(`Failed to load local ${type} data:`, error);
                return [];
            }
        }

        function saveDataToStorage(type, data) {
            try {
                localStorage.setItem(`loveSite${type}`, JSON.stringify(data));
            } catch (error) {
                console.error(`Failed to save local ${type} data:`, error);
            }
        }

        // Âπ≥ÊªëÊªöÂä®Âà∞ÊåáÂÆöÂå∫Âüü
        function scrollToSection(sectionId) {
            const element = document.getElementById(sectionId);
            if (element) {
                element.scrollIntoView({ 
                    behavior: 'smooth',
                    block: 'start'
                });
            }
        }

        // ÊòæÁ§∫ÈÄöÁü•
        function showNotification(message, type = 'info') {
            const notification = document.createElement('div');
            const colors = {
                success: 'bg-green-500',
                error: 'bg-red-500',
                info: 'bg-blue-500',
                warning: 'bg-yellow-500'
            };
            
            notification.className = `fixed top-20 right-4 z-50 px-6 py-3 rounded-lg text-white font-elegant transform translate-x-full transition-transform duration-300 ${colors[type] || colors.info}`;
            notification.textContent = message;
            
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.classList.remove('translate-x-full');
            }, 100);
            
            setTimeout(() => {
                notification.classList.add('translate-x-full');
                setTimeout(() => {
                    if (notification.parentNode) {
                        notification.parentNode.removeChild(notification);
                    }
                }, 300);
            }, 3000);
        }

        // ÈîÆÁõò‰∫ã‰ª∂ÁõëÂê¨
        document.addEventListener('keydown', function(e) {
            if (e.key === 'Enter' && e.target.id === 'messageInput' && !e.shiftKey) {
                e.preventDefault();
                addMessage();
            }
            
            // ESCÈîÆÂÖ≥Èó≠Ê®°ÊÄÅÊ°Ü
            if (e.key === 'Escape') {
                hideAddDiaryModal();
                hideAddAnniversaryModal();
            }
        });

        // ÂØºËà™Ê†èÊªöÂä®ÊïàÊûú
        window.addEventListener('scroll', function() {
            const nav = document.querySelector('nav');
            if (nav) {
                if (window.scrollY > 100) {
                    nav.style.background = 'rgba(255, 255, 255, 0.35)';
                    nav.style.backdropFilter = 'blur(20px)';
                } else {
                    nav.style.background = 'rgba(255, 255, 255, 0.25)';
                    nav.style.backdropFilter = 'blur(10px)';
                }
            }
        });

        // È°µÈù¢ÂèØËßÅÊÄßÂèòÂåñÊó∂Â§ÑÁêÜ
        document.addEventListener('visibilitychange', function() {
            if (document.hidden) {
                // È°µÈù¢ÈöêËóèÊó∂ÂÅúÊ≠¢ËÆ°Êó∂Âô®
                if (timerInterval) {
                    clearInterval(timerInterval);
                    timerInterval = null;
                }
            } else {
                // È°µÈù¢ÊòæÁ§∫Êó∂ÈáçÊñ∞ÂºÄÂßãËÆ°Êó∂Âô®
                if (isTimerRunning && !isTimerPaused) {
                    startTimer();
                }
                
                // È°µÈù¢ÊòæÁ§∫Êó∂Ëá™Âä®ÂêåÊ≠•Êï∞ÊçÆ
                if (dataSync) {
                    setTimeout(() => {
                        dataSync.syncAllData();
                    }, 1000);
                }
            }
        });

        // È°µÈù¢Âç∏ËΩΩÊó∂Ê∏ÖÁêÜ
        window.addEventListener('beforeunload', function() {
            stopTimer();
        });

        // Ê∑ªÂä†‰∏Ä‰∫õ‰∫§‰∫íÊïàÊûú
        document.addEventListener('click', function(e) {
            // ÂàõÂª∫ÁÇπÂáªÊïàÊûú
            createClickEffect(e.clientX, e.clientY);
        });

        // ÂàõÂª∫ÁÇπÂáªÊïàÊûú
        function createClickEffect(x, y) {
            const effect = document.createElement('div');
            effect.className = 'fixed pointer-events-none z-50 text-2xl animate-scaleIn opacity-70';
            effect.textContent = ['üíï', 'üíñ', 'üíò', 'üíù', 'üíì', 'üíó'][Math.floor(Math.random() * 6)];
            effect.style.left = x + 'px';
            effect.style.top = y + 'px';
            effect.style.transform = 'translate(-50%, -50%)';
            
            document.body.appendChild(effect);
            
            setTimeout(() => {
                effect.style.opacity = '0';
                effect.style.transition = 'opacity 1s ease-out';
                setTimeout(() => {
                    if (effect.parentNode) {
                        effect.parentNode.removeChild(effect);
                    }
                }, 1000);
            }, 1000);
        }

        // Êö¥Èú≤ÁªôÂÖ®Â±ÄÁöÑÈÄöÁü•ÂáΩÊï∞Ôºà‰æõleancloud-proxy‰ΩøÁî®Ôºâ
        window.showNotification = showNotification;
    </script>
</body>
</html>
